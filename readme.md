# Документация по DiskAnalyzeTool

### Введение и обзор

**Асмысл?**

Данная утилита, считывать количество ГБ на системном диске C:

Это будет полезно, если вам необходимо знать, в какое время
ваше хранилище стало свободнее или забито всяким мусором, после различных чисток 
через ```C: -> Свойства -> Очистка диска``` или других любых способов.

**Что необходимо?**

Скачайте ```Python``` последней версии по ссылке: [Скачать](https://www.python.org/downloads/release/python-3135/)

### Установка модулей:

Нам понадобится всего один **модуль**:

```bash
pip install psutil
```

Данный модуль осуществляет работу с диском.
Возможно его установка и не нужна так как может быть предустановлен в Python

### Код:

Сперва, импортируем все необходимые нам модули.

```python
import datetime # Работа с временем
import psutil  # для работы с дисками
```

Приступаем к созданию **функции** "```get_disk_usage```":

```python
def get_disk_usage():
    # Получает информацию о диске C:
    try: # Пробуем считать диск C: 
        disk = psutil.disk_usage('C:') # Переменная, в которую мы вызываем метом
        # psutil.disk_usage('С:'), вместо C: может быть любой другой диск
        return { # Возвращаем словарь: 
            'total': disk.total, # Общий размер диска
            'used': disk.used, # Используемый объём
            'free': disk.free, # Свободное место на диске
            'percent': disk.percent # Перевод в проценты
        }
    except Exception as e: # Отлавилваем ошибки
        return {'error': str(e)}
```

Следующим этапом, создаем **функцию** которая будет **"логировать"** данные о диске:

```python
def write_to_log(disk_info): # disk_info будет ниже
    # Записывает информацию в лог-файл
    log_file = 'storage.log' # Объявляем название переменной, которая будет являться файлом логирования
    timestamp = datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S') # Задаем временной формат

    with open(log_file, 'a', encoding='utf-8') as f: # Сама логика логирования начинается здесь
        if 'error' in disk_info: # Если произошла ошибка:
            f.write(f"{timestamp} - Ошибка: {disk_info['error']}\n") # Пишем что произошло
        else: # В ином случае:
            # Конвертируем байты в гигабайты для удобства чтения
            total_gb = disk_info['total'] / (1024 ** 3) # Общий размер диска
            used_gb = disk_info['used'] / (1024 ** 3) # Используемый объём
            free_gb = disk_info['free'] / (1024 ** 3) # Свободное место на диске

            f.write( # Возвращаем списком всю информацию
                f"{timestamp} - Диск C: | Всего: {total_gb:.2f} GB | "
                f"Использовано: {used_gb:.2f} GB ({disk_info['percent']}%) | "
                f"Свободно: {free_gb:.2f} GB\n"
            )
```

Теперь, создадим **основную функцию**, которая будет запускает все остальные **функции**:

```python
def main():
    disk_info = get_disk_usage() # disk_info это файл в который мы передаем значения из get_disk_usage()
    print('Была проведена диагностика. Смотрите файл "storage.log"')
    write_to_log(disk_info) # Создаем файл логирования
    input() # Нажми любую кнопку что бы выйти
```

Осталась лишь **точка входа** в программу:

```python
if __name__ == "__main__":
    main()
```

### Как использовать?

**Windows**:

Поместите **ярлык** ```main.py``` в папку "Автозагрузка":

1. Нажмите Win+R, введите ```shell:startup`` и нажмите Enter
2. Перетащите ярлык в открывшуюся папку

**Linux**:

1. Сохраните **программу(скрипт)** (например, в ```/usr/local/bin/disk_monitor.py```)
2. Сделайте его исполняемым:
```bash
chmod +x /usr/local/bin/disk_monitor.py
```
3. Добавьте в автозагрузку через **cron**:

Откройте crontab: ```crontab -e```

Добавьте строку:

```bash
@reboot python3 /usr/local/bin/disk_monitor.py
```

P.S:

Вы также можете просто открывать программу сколько угодно, без надобности в перемещении ярлыка
в автозагрузку, как вам удобно.

Пользуйтесь!

### Источники:

[Python](https://www.python.org/)

[psutil](https://pypi.org/project/psutil/)